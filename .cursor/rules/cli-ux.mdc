---
description: Visual and UX standards for the buyruk CLI
alwaysApply: false
---
# CLI UX & Rendering Rules

## Visuals
- **Styles**: Use `charmbracelet/lipgloss` for all colors and padding.
- **Tables**: Use `olekukonko/tablewriter` for lists.
- **Markdown**: Use `charmbracelet/glamour` for rendering task descriptions.

## Cross-Platform UI
- Do not use symbols that are known to break in standard Windows CMD (stick to basic UTF-8 or provide fallbacks).
- Errors MUST be written to `os.Stderr` and styled in Red.
- Success messages should be styled in Green.

## Command Structure
- All commands are built using `spf13/cobra`.
- Every command must have a `.Short` and `.Long` description.
- Use `PersistentFlags` for global configuration like `--project` or `--format`.
- **Output Handling**: Always use `cmd.OutOrStdout()` and `cmd.ErrOrStderr()` instead of `os.Stdout`/`os.Stderr` for testability.
- **Error Handling**: Use `RunE` (returns error) instead of `Run` when errors need to be propagated.
- **Command Factory**: Each command should be in its own file with a `New<Command>Cmd() *cobra.Command` function.

## Flag Access Patterns

- **No Global Variables**: Never store flag values in package-level variables. This causes test pollution and race conditions.
- **Access Through Command Context**: Always access flags through the `*cobra.Command` parameter in `RunE`:
  ```go
  format, _ := cmd.Flags().GetString("format")
  // Or use helper: format := GetFormat(cmd)
  ```
- **Persistent Flags**: Persistent flags are inherited by subcommands and accessible via `cmd.Flags().GetString()`.
- **Flag Definition**: Define flags without binding to variables: `rootCmd.PersistentFlags().String("format", "modern", "description")`
- **Helper Functions**: Create helper functions that accept `*cobra.Command` for flag access (e.g., `GetFormat(cmd)`, `GetProject(cmd)`).